<!DOCTYPE html>
<html lang="en">
<head>
    <title>Player with Gestures</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-Frame-Options" content="deny">

    <!-- Plyr Player CSS -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <!-- Font Awesome for Feedback Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Plyr Player JS -->
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>

    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
            background-color: #000;
            overflow: hidden; /* Page scroll ko rokne ke liye */
        }

        #player-container {
            width: 100%;
            height: 100%;
            position: relative; /* Gesture overlay ke liye */
        }
        
        .plyr, .plyr__video-wrapper {
            height: 100%;
            width: 100%;
        }

        /* Gesture feedback indicator styling */
        #gesture-feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 24px;
            z-index: 20;
            opacity: 0;
            transition: opacity 0.2s ease-out;
            pointer-events: none; /* Iske through click pass ho jayega */
            display: flex;
            align-items: center;
            flex-direction: column;
        }

        #gesture-feedback.visible {
            opacity: 1;
        }

        #gesture-feedback i {
            font-size: 36px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div id="player-container">
        <video id="player" controls preload="auto"></video>
        <!-- Feedback indicator element -->
        <div id="gesture-feedback"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIGURATION ---
            const videoSrc = 'https://cdn.plyr.io/static/demo/View_From_A_Blue_Moon_Trailer-1080p.mp4';
            // --- END CONFIGURATION ---

            const videoElement = document.getElementById('player');
            videoElement.innerHTML = `<source src="${videoSrc}" type="video/mp4">`;

            const player = new Plyr('#player', {
                controls: [
                    'play-large', 'restart', 'rewind', 'play', 'fast-forward', 'progress',
                    'current-time', 'duration', 'mute', 'volume', 'settings', 'pip',
                    'airplay', 'fullscreen'
                ],
                settings: ['speed', 'loop'],
                speed: { selected: 1, options: [0.5, 0.75, 1, 1.25, 1.5, 2] },
                keyboard: { focused: true, global: true },
                tooltips: { controls: true, seek: true },
            });

            // Landscape mode logic
            player.on('enterfullscreen', () => screen.orientation?.lock('landscape').catch(() => {}));
            player.on('exitfullscreen', () => screen.orientation?.unlock());

            // --- GESTURE & SEEK LOGIC ---
            const playerContainer = document.getElementById('player-container');
            const feedbackElement = document.getElementById('gesture-feedback');
            
            let lastTap = 0;
            let touchStartX = 0;
            let touchStartY = 0;
            let touchAction = ''; // 'seek', 'volume', 'brightness'
            let initialBrightness = 1;
            let hideFeedbackTimeout;

            function showFeedback(iconClass, text) {
                clearTimeout(hideFeedbackTimeout);
                feedbackElement.innerHTML = `<i class="fas ${iconClass}"></i><span>${text}</span>`;
                feedbackElement.classList.add('visible');
                hideFeedbackTimeout = setTimeout(() => {
                    feedbackElement.classList.remove('visible');
                }, 800);
            }

            playerContainer.addEventListener('touchstart', (e) => {
                // Sirf single touch ko handle karenge
                if (e.touches.length === 1) {
                    const touch = e.touches[0];
                    touchStartX = touch.clientX;
                    touchStartY = touch.clientY;
                    touchAction = ''; // Har baar action ko reset karein
                }
            }, { passive: true });

            playerContainer.addEventListener('touchmove', (e) => {
                // Page scroll ko rokein jab player par swipe ho raha ho
                e.preventDefault();

                if (e.touches.length === 1) {
                    const touch = e.touches[0];
                    const deltaX = touch.clientX - touchStartX;
                    const deltaY = touch.clientY - touchStartY;

                    // Pehli baar decide karein ki yeh horizontal swipe hai ya vertical
                    if (touchAction === '') {
                        if (Math.abs(deltaX) > Math.abs(deltaY)) {
                            touchAction = 'seek';
                        } else {
                            // Screen ke side ke hisaab se action set karein
                            if (touchStartX < window.innerWidth / 2) {
                                touchAction = 'brightness';
                            } else {
                                touchAction = 'volume';
                            }
                        }
                    }

                    // Action ke hisaab se kaam karein
                    if (touchAction === 'seek') {
                        const seekAmount = deltaX / 10; // Swipe speed se seek amount control karein
                        player.currentTime += seekAmount;
                        showFeedback('fa-history', `${player.currentTime.toFixed(0)}s`);
                        // Naye start point set karein taaki seek smooth ho
                        touchStartX = touch.clientX;
                    } else if (touchAction === 'volume') {
                        const volumeChange = -deltaY / 100; // Swipe up = volume increase
                        player.volume = Math.max(0, Math.min(1, player.volume + volumeChange));
                        showFeedback('fa-volume-up', `${(player.volume * 100).toFixed(0)}%`);
                        touchStartY = touch.clientY;
                    } else if (touchAction === 'brightness') {
                        const brightnessChange = -deltaY / 100;
                        initialBrightness = Math.max(0, Math.min(2, initialBrightness + brightnessChange));
                        player.elements.container.style.filter = `brightness(${initialBrightness})`;
                        showFeedback('fa-sun', `${(initialBrightness * 100).toFixed(0)}%`);
                        touchStartY = touch.clientY;
                    }
                }
            }, { passive: false }); // passive: false zaroori hai preventDefault ke liye

            playerContainer.addEventListener('touchend', (e) => {
                const currentTime = new Date().getTime();
                const tapLength = currentTime - lastTap;

                if (tapLength < 300 && tapLength > 0) {
                    // Double Tap Hua Hai
                    const rect = playerContainer.getBoundingClientRect();
                    const tapX = e.changedTouches[0].clientX - rect.left;

                    if (tapX < rect.width / 2) {
                        // Left Side Tap
                        player.rewind();
                        showFeedback('fa-backward', '-10s');
                    } else {
                        // Right Side Tap
                        player.forward();
                        showFeedback('fa-forward', '+10s');
                    }
                    e.preventDefault(); // Default double-tap zoom ko rokein
                }
                lastTap = currentTime;
                touchAction = ''; // Action ko end par clear karein
            });
        });
    </script>

</body>
</html>
